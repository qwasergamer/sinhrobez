<!DOCTYPE html>
<html lang="ru">
<head>
<link rel="icon" href="images/logo.ico"><!-- 32×32 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Поддержка - Синхро-Безопасность</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Чердак -->
    <div class="top-bar">
        <div class="container">
            <div class="top-contacts">
                <div class="top-contact-item">
                    <i class="fas fa-phone"></i>
                    <span>+7 (919) 157-79-00</span>
                </div>
                <div class="top-contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>vladimir_minkov@mail.ru</span>
                </div>
            </div>
            <a href="contacts.html#demo" class="top-cta">Заказать демо</a>
        </div>
    </div>

    <!-- Шапка -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <div class="logo-icon">СБ</div>
                    <div class="logo-text">
                        <h1>Синхро-Безопасность</h1>
                        <p class="tagline">Промышленная автоматизация контроля доступа</p>
                    </div>
                </a>
                <nav class="main-nav" id="mainNav">
                    <ul>
                        <li><a href="index.html"><i class="fas fa-home"></i>Главная</a></li>
                        <li><a href="about.html"><i class="fas fa-info-circle"></i>О продукте</a></li>
                        <li><a href="features.html"><i class="fas fa-star"></i>Возможности</a></li>
                        <li><a href="technology.html"><i class="fas fa-cogs"></i>Технологии</a></li>
                        <li><a href="support.html" class="active"><i class="fas fa-headset"></i>Поддержка</a></li>
                    </ul>
                </nav>
                <button class="side-menu-btn" id="sideMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Боковое меню -->
    <div class="side-menu" id="sideMenu">
        <div class="side-menu-header">
            <h3>Все разделы</h3>
            <button class="close-side-menu" id="closeSideMenu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="side-menu-nav">
            <ul>
                <li><a href="index.html"><i class="fas fa-home"></i>Главная</a></li>
                <li><a href="about.html"><i class="fas fa-info-circle"></i>О продукте</a></li>
                <li><a href="features.html"><i class="fas fa-star"></i>Возможности</a></li>
                <li><a href="technology.html"><i class="fas fa-cogs"></i>Технологии</a></li>
                <li><a href="requirements.html"><i class="fas fa-server"></i>Требования</a></li>
                <li><a href="installation.html"><i class="fas fa-download"></i>Установка</a></li>
                <li><a href="docs.html"><i class="fas fa-book"></i>Документация</a></li>
                <li><a href="contacts.html"><i class="fas fa-phone"></i>Контакты</a></li>
                <li><a href="download.html"><i class="fas fa-file-download"></i>Скачать</a></li>
                <li><a href="support.html"><i class="fas fa-headset"></i>Поддержка</a></li>
                <li><a href="integration.html"><i class="fas fa-link"></i>Интеграция</a></li>
                <li><a href="privacy.html"><i class="fas fa-shield-alt"></i>Политика</a></li>
            </ul>
        </nav>
    </div>

    <!-- Заголовок страницы -->
    <section class="page-header">
        <div class="container">
            <h1>Техническая поддержка</h1>
            <div class="breadcrumb">
                <a href="index.html">Главная</a> / <span>Поддержка</span>
            </div>
        </div>
    </section>

    <!-- Содержимое страницы -->
    <section class="content-section">
        <div class="container">
            <div style="text-align: center; margin-bottom: 50px;">
                <h2 style="color: var(--oil-dark); margin-bottom: 20px; font-size: 2rem;">
                    Техническая поддержка и помощь
                </h2>
                <p style="max-width: 800px; margin: 0 auto; font-size: 1.1rem; color: var(--oil-steel);">
                    Поддержка для промышленных предприятий. Решаем проблемы с Samba DC, RedOS и интеграцией с 1С
                </p>
            </div>

            <!-- Каналы поддержки -->
            <div style="margin-bottom: 60px;">
                <h3 style="color: var(--oil-dark); margin-bottom: 30px; text-align: center;">
                    <i class="fas fa-comments" style="color: var(--oil-gold); margin-right: 10px;"></i>
                    Каналы поддержки
                </h3>
                
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-phone-volume"></i>
                        </div>
                        <h3>Телефонная поддержка</h3>
                        <p>
                            <strong>Режим работы:</strong> Пн-Пт 9:00-18:00 МСК<br>
                            <strong>Среднее время ответа:</strong> 5-15 минут<br>
                            <strong>Приоритет для:</strong> Промышленных предприятий
                        </p>
                        <div style="margin-top: 20px; padding: 15px; background: var(--oil-light); border-radius: 8px; text-align: center;">
                            <i class="fas fa-phone" style="color: var(--oil-gold); font-size: 1.2rem; margin-right: 10px;"></i>
                            <strong style="color: var(--oil-dark); font-size: 1.2rem;">+7 (919) 157-79-00</strong>
                        </div>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h3>Электронная почта</h3>
                        <p>
                            <strong>Время ответа:</strong> До 1 рабочего дня<br>
                            <strong>Форматы вложений:</strong> DOCX, TXT, LOG, PNG<br>
                            <strong>Максимальный размер:</strong> 25 MB
                        </p>
                        <div style="margin-top: 20px; padding: 15px; background: var(--oil-light); border-radius: 8px; text-align: center;">
                            <i class="fas fa-envelope" style="color: var(--oil-gold); font-size: 1.2rem; margin-right: 10px;"></i>
                            <strong style="color: var(--oil-dark); font-size: 1.1rem;">vladimir_minkov@mail.ru</strong>
                        </div>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-desktop"></i>
                        </div>
                        <h3>Удалённая поддержка</h3>
                        <p>
                            <strong>Удалённый доступ:</strong> TeamViewer, AnyDesk<br>
                            <strong>Время подключения:</strong> По предварительной договорённости<br>
                            <strong>Длительность сессии:</strong> До 2 часов<br>
                            <strong>Требуется:</strong> Согласие администратора
                        </p>
                        <div style="margin-top: 20px;">
                            <button id="remoteHelpBtn" class="btn btn-primary" style="padding: 10px 20px; font-size: 0.9rem;">
                                <i class="fas fa-desktop"></i> Заполнить заявку
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Форма обращения в поддержку -->
            <div style="background: var(--oil-light); padding: 40px; border-radius: 10px; margin-bottom: 40px;">
                <h3 style="color: var(--oil-dark); margin-bottom: 25px; text-align: center;">
                    <i class="fas fa-life-ring" style="color: var(--oil-gold); margin-right: 10px;"></i>
                    Форма обращения в поддержку
                </h3>
                
                <form id="supportForm" style="max-width: 600px; margin: 0 auto;">
                    <div class="form-group">
                        <label for="supportName">Ваше имя *</label>
                        <input type="text" id="supportName" class="form-control" required placeholder="Алукард Цепеш">
                    </div>
                    
                    <div class="form-group">
                        <label for="supportCompany">Компания *</label>
                        <input type="text" id="supportCompany" class="form-control" required placeholder="ООО 'Промышленные Решения'">
                    </div>
                    
                    <div class="form-group">
                        <label for="supportPhone">Телефон *</label>
                        <input type="tel" id="supportPhone" class="form-control" required placeholder="+7 (999) 123-45-67">
                    </div>
                    
                    <div class="form-group">
                        <label for="supportEmail">Email *</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="supportEmailName" class="form-control" style="flex: 1;" placeholder="Ваше имя в почте">
                            <span style="align-self: center; font-size: 1.2rem;">@</span>
                            <select id="supportEmailDomain" class="form-control" style="flex: 1;">
                                <option value="mail.ru">mail.ru</option>
                                <option value="gmail.com">gmail.com</option>
                                <option value="yandex.ru">yandex.ru</option>
                                <option value="bk.ru">bk.ru</option>
                                <option value="list.ru">list.ru</option>
                                <option value="rambler.ru">rambler.ru</option>
                                <option value="outlook.com">outlook.com</option>
                                <option value="company.ru">company.ru</option>
                                <option value="other">другой</option>
                            </select>
                        </div>
                        <input type="hidden" id="supportEmail" name="supportEmail">
                        <div id="supportCustomDomain" style="display: none; margin-top: 10px;">
                            <input type="text" id="supportOtherDomain" class="form-control" placeholder="Введите ваш домен (например: mycompany.com)">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="supportSystem">Используемая система</label>
                        <select id="supportSystem" class="form-control">
                            <option value="">Выберите систему</option>
                            <option value="samba">Samba DC (RedOS)</option>
                            <option value="ad">Active Directory (Windows)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="supportProblem">Описание проблемы *</label>
                        <textarea id="supportProblem" class="form-control" rows="5" required placeholder="Подробно опишите проблему, шаги воспроизведения, код ошибки если есть..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="supportLogs">Приложите файлы (логи, скриншоты)</label>
                        <div style="border: 2px dashed #ddd; padding: 20px; text-align: center; border-radius: 6px; background: white;">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--oil-steel); margin-bottom: 10px;"></i>
                            <p style="color: var(--oil-steel); margin-bottom: 15px;">Перетащите файлы сюда или нажмите для выбора</p>
                            <input type="file" id="supportLogs" class="form-control" style="display: none;" multiple>
                            <button type="button" id="selectFilesBtn" class="btn btn-primary" style="padding: 8px 20px;">
                                <i class="fas fa-folder-open"></i> Выбрать файлы
                            </button>
                            <div id="fileList" style="margin-top: 15px; font-size: 0.9rem; color: var(--oil-steel);"></div>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--oil-steel); margin-top: 5px;">
                            Максимум 5 файлов, не более 10 MB каждый. Поддерживаемые форматы: TXT, LOG, DOCX, PNG, JPG
                        </p>
                    </div>
                    
                    <div class="form-group" style="display: flex; align-items: flex-start; gap: 10px;">
                        <input type="checkbox" id="supportAgree" style="margin-top: 5px;" required>
                        <label for="supportAgree" style="font-size: 0.9rem; color: var(--oil-steel);">
                            Я согласен на обработку персональных данных и передачу диагностической информации *
                        </label>
                    </div>
                    
                    <div class="form-group" style="text-align: center;">
                        <button type="submit" class="btn btn-primary" style="padding: 15px 40px; font-size: 1.1rem;" id="supportSubmitBtn">
                            <i class="fas fa-paper-plane"></i> Отправить обращение
                        </button>
                    </div>
                </form>
            </div>

            <!-- Часто задаваемые вопросы -->
            <div style="margin-bottom: 60px;">
                <h3 style="color: var(--oil-dark); margin-bottom: 30px; text-align: center;">
                    <i class="fas fa-question-circle" style="color: var(--oil-gold); margin-right: 10px;"></i>
                    Часто задаваемые вопросы (FAQ)
                </h3>
                
                <div id="faqAccordion" style="max-width: 800px; margin: 0 auto;">
                    <!-- FAQ 1 -->
                    <div style="background: white; margin-bottom: 10px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                        <div style="width: 100%; text-align: left; padding: 20px; background: var(--oil-light); font-size: 1.1rem; font-weight: 600; color: var(--oil-dark); display: flex; justify-content: space-between; align-items: center;">
                            <span>Модуль не подключается к Samba DC. Что делать?</span>
                        </div>
                        <div style="padding: 20px; color: var(--oil-steel); line-height: 1.7;">
                            <p><strong>Шаг 1:</strong> Проверьте доступность контроллера домена по сети (ping dc.yourdomain.com)</p>
                            <p><strong>Шаг 2:</strong> Убедитесь, что учётная запись имеет права на создание групп безопасности</p>
                            <p><strong>Шаг 3:</strong> Проверьте настройки LDAP/порты в конфигурации Samba (по умолчанию порт 389)</p>
                            <p><strong>Шаг 4:</strong> Посмотрите логи Samba: <code>tail -f /var/log/samba/log.smbd</code></p>
                            <p>Если проблема не решена, отправьте нам логи через форму выше.</p>
                        </div>
                    </div>
                    
                    <!-- FAQ 2 -->
                    <div style="background: white; margin-bottom: 10px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                        <div style="width: 100%; text-align: left; padding: 20px; background: var(--oil-light); font-size: 1.1rem; font-weight: 600; color: var(--oil-dark); display: flex; justify-content: space-between; align-items: center;">
                            <span>Синхронизация работает очень медленно (>30 минут)</span>
                        </div>
                        <div style="padding: 20px; color: var(--oil-steel); line-height: 1.7;">
                            <p><strong>Возможные причины и решения:</strong></p>
                            <p>1. <strong>Сетевая задержка:</strong> Проверьте ping между сервером модуля и контроллером домена</p>
                            <p>2. <strong>Нагрузка на сервер:</strong> Увеличьте ресурсы сервера (RAM, CPU)</p>
                            <p>3. <strong>Оптимизация запросов:</strong> Настройте индексы в базе данных 1С</p>
                            <p>4. <strong>Размер оргструктуры:</strong> Для >5000 пользователей рекомендуем сервер 8+ ядер, 16+ GB RAM</p>
                            <p>5. <strong>Конфигурация:</strong> Включите пакетную обработку в настройках модуля</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Подвал -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Синхро-Безопасность</h3>
                    <p>Профессиональное решение для автоматизации управления группами безопасности.</p>
                </div>
                <div class="footer-col">
                    <h3>Поддержка</h3>
                    <ul class="footer-contact">
                        <li><i class="fas fa-phone"></i> +7 (919) 157-79-00</li>
                        <li><i class="fas fa-envelope"></i> vladimir_minkov@mail.ru</li>
                        <li><i class="fas fa-clock"></i> Пн-Пт: 9:00-18:00 МСК</li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Быстрые ссылки</h3>
                    <ul class="footer-links">
                        <li><a href="download.html"><i class="fas fa-download"></i> Скачать демо</a></li>
                        <li><a href="docs.html"><i class="fas fa-book"></i> Документация</a></li>
                        <li><a href="installation.html"><i class="fas fa-cogs"></i> Установка</a></li>
                        <li><a href="contacts.html"><i class="fas fa-calendar"></i> Консультация</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span class="current-year">2025</span> Синхро-Безопасность. Все права защищены.</p>
                <p>Техническая поддержка для промышленных предприятий РФ и СНГ</p>
            </div>
        </div>
    </footer>

    <!-- Модальное окно для удалённой помощи -->
    <div class="modal" id="remoteHelpModal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-modal" id="closeRemoteModal">&times;</span>
            <h2 style="color: var(--oil-dark); margin-bottom: 20px;">Запрос удалённой помощи</h2>
            <p style="color: var(--oil-steel); margin-bottom: 25px;">
                Заполните форму обращения выше, указав в описании проблемы, что вам требуется удалённая поддержка. Наш специалист свяжется с вами для организации подключения.
            </p>
            <div style="text-align: center;">
                <button id="goToFormBtn" class="btn btn-primary" style="padding: 12px 30px;">
                    <i class="fas fa-arrow-down"></i> Перейти к форме обращения
                </button>
            </div>
        </div>
    </div>

    <!-- Модальное окно успешной отправки -->
    <div class="modal" id="successModal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <span class="close-modal" id="closeSuccessModal">&times;</span>
            <div style="width: 80px; height: 80px; background: var(--oil-green); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 40px;">
                <i class="fas fa-check"></i>
            </div>
            <h2 style="color: var(--oil-dark); margin-bottom: 15px;">Обращение отправлено!</h2>
            <p style="color: var(--oil-steel); margin-bottom: 10px;">
                <strong>Номер вашего обращения: #<span id="ticketNumber">0000</span></strong>
            </p>
            <p style="color: var(--oil-steel); margin-bottom: 25px;">
                ✅ Данные сохранены в системе.<br><br>
                Наш специалист свяжется с вами в рабочее время.
                Сохраните номер обращения для отслеживания.
            </p>
            <button class="btn btn-primary" id="closeSuccessBtn">
                <i class="fas fa-times"></i> Закрыть
            </button>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
    // ===== JavaScript для обработки формы поддержки =====
    document.addEventListener('DOMContentLoaded', function() {
        console.log('Страница поддержки загружена');
        
        // Обработка email с выбором домена
        const emailName = document.getElementById('supportEmailName');
        const emailDomain = document.getElementById('supportEmailDomain');
        const customDomain = document.getElementById('supportCustomDomain');
        const otherDomain = document.getElementById('supportOtherDomain');
        const emailField = document.getElementById('supportEmail');
        
        // Обновление скрытого поля email
        function updateEmail() {
            let domain = emailDomain.value;
            if (domain === 'other') {
                domain = otherDomain.value;
            }
            if (emailName.value && domain) {
                emailField.value = emailName.value + '@' + domain;
            } else {
                emailField.value = '';
            }
        }
        
        // События для обновления email
        if (emailName) emailName.addEventListener('input', updateEmail);
        if (emailDomain) {
            emailDomain.addEventListener('change', function() {
                if (this.value === 'other') {
                    if (customDomain) customDomain.style.display = 'block';
                } else {
                    if (customDomain) customDomain.style.display = 'none';
                    updateEmail();
                }
            });
        }
        if (otherDomain) otherDomain.addEventListener('input', updateEmail);
        
        // Обработка выбора файлов
        const fileInput = document.getElementById('supportLogs');
        const selectFilesBtn = document.getElementById('selectFilesBtn');
        const fileList = document.getElementById('fileList');
        
        if (selectFilesBtn) {
            selectFilesBtn.addEventListener('click', function() {
                if (fileInput) fileInput.click();
            });
        }
        
        if (fileInput) {
            fileInput.addEventListener('change', function() {
                if (fileList) fileList.innerHTML = '';
                const files = Array.from(this.files);
                
                if (files.length > 5) {
                    alert('Можно выбрать не более 5 файлов');
                    this.value = '';
                    return;
                }
                
                files.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 8px; background: white; border-radius: 4px; margin-bottom: 5px;';
                    fileItem.innerHTML = `
                        <span style="font-size: 0.9rem;">
                            <i class="fas fa-file" style="color: var(--oil-steel); margin-right: 8px;"></i>
                            ${file.name} (${(file.size / 1024).toFixed(1)} KB)
                        </span>
                        <button type="button" class="remove-file" data-index="${index}" style="background: none; border: none; color: var(--oil-fire); cursor: pointer;">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    if (fileList) fileList.appendChild(fileItem);
                });
                
                // Обработчики удаления файлов
                document.querySelectorAll('.remove-file').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        const dt = new DataTransfer();
                        const filesArray = Array.from(fileInput.files);
                        
                        filesArray.splice(index, 1);
                        filesArray.forEach(file => dt.items.add(file));
                        
                        fileInput.files = dt.files;
                        fileInput.dispatchEvent(new Event('change'));
                    });
                });
            });
        }
        
        // ===== Обработка отправки формы поддержки =====
        const supportForm = document.getElementById('supportForm');
        const supportSubmitBtn = document.getElementById('supportSubmitBtn');
        
        if (supportForm) {
            supportForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                console.log('Отправка обращения в поддержку...');
                
                // Проверка согласия
                const agreeCheck = document.getElementById('supportAgree');
                if (!agreeCheck || !agreeCheck.checked) {
                    alert('❌ Для отправки обращения необходимо согласиться на обработку данных');
                    return;
                }
                
                // Собираем данные
                const formData = {
                    name: document.getElementById('supportName').value.trim(),
                    company: document.getElementById('supportCompany').value.trim(),
                    phone: document.getElementById('supportPhone').value.trim(),
                    email: emailField.value.trim(),
                    system: document.getElementById('supportSystem').value,
                    problem: document.getElementById('supportProblem').value.trim()
                };
                
                // Валидация
                if (!formData.name || !formData.company || !formData.phone || !formData.email || !formData.problem) {
                    alert('❌ Пожалуйста, заполните все обязательные поля');
                    return;
                }
                
                // Проверка email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(formData.email)) {
                    alert('❌ Введите корректный email адрес');
                    return;
                }
                
                // Показываем загрузку
                const originalText = supportSubmitBtn.innerHTML;
                supportSubmitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Отправка...';
                supportSubmitBtn.disabled = true;
                
                try {
                    // Генерируем номер тикета
                    const ticketNumber = 'T' + Date.now().toString().slice(-6);
                    
                    // Сохраняем в localStorage
                    const saveResult = saveSupportRequest(formData, ticketNumber);
                    
                    // Показываем модальное окно с номером тикета
                    const ticketNumberSpan = document.getElementById('ticketNumber');
                    if (ticketNumberSpan) {
                        ticketNumberSpan.textContent = ticketNumber;
                    }
                    
                    document.getElementById('successModal').style.display = 'flex';
                    
                    // Очищаем форму
                    supportForm.reset();
                    emailField.value = '';
                    if (customDomain) customDomain.style.display = 'none';
                    if (otherDomain) otherDomain.value = '';
                    if (fileList) fileList.innerHTML = '';
                    if (fileInput) fileInput.value = '';
                    
                    console.log('✅ Обращение сохранено, тикет:', ticketNumber);
                    
                    // Отправка через mailto как резервный вариант
                    const backupEmail = `mailto:vladimir_minkov@mail.ru?subject=Обращение в поддержку #${ticketNumber}&body=${encodeURIComponent(
                        `Новое обращение в поддержку #${ticketNumber}:\n\n` +
                        `Имя: ${formData.name}\n` +
                        `Компания: ${formData.company}\n` +
                        `Телефон: ${formData.phone}\n` +
                        `Email: ${formData.email}\n` +
                        `Система: ${formData.system || 'Не указана'}\n` +
                        `Проблема: ${formData.problem}\n\n` +
                        `---\nДата: ${new Date().toLocaleString()}`
                    )}`;
                    
                    // Предлагаем отправить через почту
                    setTimeout(() => {
                        if (confirm('Обращение сохранено! Открыть почтовый клиент для отправки?')) {
                            window.location.href = backupEmail;
                        }
                    }, 500);
                    
                } catch (error) {
                    console.error('Ошибка:', error);
                    alert('❌ Ошибка при сохранении обращения');
                } finally {
                    // Восстанавливаем кнопку
                    supportSubmitBtn.innerHTML = originalText;
                    supportSubmitBtn.disabled = false;
                }
            });
        }
        
        // Функция сохранения в localStorage
        function saveSupportRequest(formData, ticketNumber) {
            try {
                let requests = JSON.parse(localStorage.getItem('sync_support_requests') || '[]');
                
                formData.ticket_number = ticketNumber;
                formData.timestamp = new Date().toISOString();
                formData.created_at = formData.timestamp;
                formData.type = 'support';
                formData.id = Date.now();
                
                requests.push(formData);
                
                if (requests.length > 100) {
                    requests = requests.slice(-50);
                }
                
                localStorage.setItem('sync_support_requests', JSON.stringify(requests));
                
                console.log('Обращение в поддержку сохранено:', formData);
                console.log('Всего обращений:', requests.length);
                
                return { success: true, count: requests.length };
            } catch (error) {
                console.error('Ошибка сохранения:', error);
                return { success: false, error: error.message };
            }
        }
        
        // Удалённая помощь
        const remoteHelpBtn = document.getElementById('remoteHelpBtn');
        const remoteHelpModal = document.getElementById('remoteHelpModal');
        const closeRemoteModal = document.getElementById('closeRemoteModal');
        const goToFormBtn = document.getElementById('goToFormBtn');
        
        if (remoteHelpBtn) {
            remoteHelpBtn.addEventListener('click', function() {
                if (remoteHelpModal) {
                    remoteHelpModal.style.display = 'flex';
                }
            });
        }
        
        if (closeRemoteModal) {
            closeRemoteModal.addEventListener('click', function() {
                if (remoteHelpModal) {
                    remoteHelpModal.style.display = 'none';
                }
            });
        }
        
        if (goToFormBtn) {
            goToFormBtn.addEventListener('click', function() {
                if (remoteHelpModal) {
                    remoteHelpModal.style.display = 'none';
                }
                const form = document.getElementById('supportForm');
                if (form) {
                    form.scrollIntoView({ behavior: 'smooth' });
                    const problemField = document.getElementById('supportProblem');
                    if (problemField) {
                        problemField.focus();
                        problemField.value = 'Требуется удалённая поддержка. ';
                    }
                }
            });
        }
        
        // Обработчики модальных окон
        const successModal = document.getElementById('successModal');
        const closeSuccessModal = document.getElementById('closeSuccessModal');
        const closeSuccessBtn = document.getElementById('closeSuccessBtn');
        
        if (closeSuccessModal) {
            closeSuccessModal.addEventListener('click', function() {
                successModal.style.display = 'none';
            });
        }
        
        if (closeSuccessBtn) {
            closeSuccessBtn.addEventListener('click', function() {
                successModal.style.display = 'none';
            });
        }
        
        // Закрытие модальных окон при клике вне
        window.addEventListener('click', function(e) {
            if (successModal && e.target === successModal) successModal.style.display = 'none';
            if (remoteHelpModal && e.target === remoteHelpModal) remoteHelpModal.style.display = 'none';
        });
        
        // Автоформатирование телефона
        const phoneInput = document.getElementById('supportPhone');
        if (phoneInput) {
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.startsWith('7') || value.startsWith('8')) {
                    value = value.substring(1);
                }
                
                if (value.length > 0) {
                    value = '+7 (' + value;
                    if (value.length > 7) value = value.substring(0, 7) + ') ' + value.substring(7);
                    if (value.length > 12) value = value.substring(0, 12) + '-' + value.substring(12);
                    if (value.length > 15) value = value.substring(0, 15) + '-' + value.substring(15);
                    if (value.length > 18) value = value.substring(0, 18);
                }
                
                e.target.value = value;
            });
        }
    });
    </script>
</body>
</html>
